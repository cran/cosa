<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Metin Bulus &amp; Nianbo Dong" />

<meta name="date" content="2021-11-20" />

<title> Bound Constrained Optimal Design of Multilevel Regression Discontinuity Designs and Randomized Controlled Trials</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore"><span style="color: grey;"> Bound Constrained Optimal Design of Multilevel Regression Discontinuity Designs and Randomized Controlled Trials </span></h1>
<h4 class="author">Metin Bulus &amp; Nianbo Dong</h4>
<h4 class="date">2021-11-20</h4>


<div id="TOC">
<ul>
<li><a href="#primary-constraint-on-the-total-cost">Primary Constraint on the Total Cost</a></li>
<li><a href="#primary-constraint-on-the-effect-size">Primary Constraint on the Effect Size</a></li>
<li><a href="#primary-constraint-on-the-power-rate">Primary Constraint on the Power Rate</a></li>
</ul>
</div>

<p>To install and load the package:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;cosa&quot;</span>)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(cosa)</a></code></pre></div>
<p>The following examples demonstrate how to perform bound constrained optimal sample size allocation (BCOSSA) for a two-level cluster randomized trial (CRT) and for the corresponding cluster-level regression discontinuity (CRD) design under three primary constraints. Note: <code>NULL</code> arguments are provided for clarity, otherwise they do not have to be explicit.</p>
<div id="primary-constraint-on-the-total-cost" class="section level2">
<h2>Primary Constraint on the Total Cost</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># cost constrained - optimize p and n2</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="co"># CRT(&#39;order = 0&#39; or &#39;rhots = 0&#39;)</span></a>
<a class="sourceLine" id="cb2-3" title="3">crt &lt;-<span class="st"> </span><span class="kw">cosa.crd2</span>(<span class="dt">order =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb2-4" title="4">                 <span class="dt">constrain =</span> <span class="st">&quot;cost&quot;</span>, <span class="dt">cost =</span> <span class="dv">12500</span>, </a>
<a class="sourceLine" id="cb2-5" title="5">                 <span class="dt">cn1 =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">2</span>), <span class="dt">cn2 =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb2-6" title="6">                 <span class="dt">es =</span> <span class="fl">.20</span>,  <span class="dt">power =</span> <span class="fl">.80</span>, <span class="dt">rho2 =</span> <span class="fl">.20</span>,</a>
<a class="sourceLine" id="cb2-7" title="7">                 <span class="dt">g2 =</span> <span class="dv">1</span>, <span class="dt">r21 =</span> <span class="fl">.20</span>, <span class="dt">r22 =</span> <span class="fl">.30</span>, </a>
<a class="sourceLine" id="cb2-8" title="8">                 <span class="dt">p =</span> <span class="ot">NULL</span>, <span class="dt">n1 =</span> <span class="dv">20</span>,  <span class="dt">n2 =</span> <span class="ot">NULL</span>)</a></code></pre></div>
<pre><code>## Solution converged with LBFGS 
## 
## Rounded solution: 
## --------------------------------------------------- 
##  [n1]  n2     p [cost]  mdes 95%lcl 95%ucl power
##    20 132 0.386  12510 0.209  0.063  0.356 0.764
## --------------------------------------------------- 
## Per unit marginal costs: 
##  Level 1 treatment: 5 
##  Level 1 control: 2 
##  Level 2 treatment: 50 
##  Level 2 control: 20 
## --------------------------------------------------- 
## MDES = 0.209 (with power = 80) 
## power = 0.764 (for ES = 0.2) 
## --------------------------------------------------- 
## []: point constrained (fixed) 
## &lt;&lt;: bound constrained 
## Random assignment design</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># comparisons to CRDs</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co"># CRD w/ linear score variable interacting with the treatment</span></a>
<a class="sourceLine" id="cb4-3" title="3">crd1 &lt;-<span class="st"> </span><span class="kw">cosa.crd2</span>(<span class="dt">order =</span> <span class="dv">1</span>, <span class="dt">interaction =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb4-4" title="4">                  <span class="dt">constrain =</span> <span class="st">&quot;cost&quot;</span>, <span class="dt">cost =</span> <span class="dv">12500</span>,</a>
<a class="sourceLine" id="cb4-5" title="5">                  <span class="dt">cn1 =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">2</span>), <span class="dt">cn2 =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb4-6" title="6">                  <span class="dt">es =</span> <span class="fl">.20</span>,  <span class="dt">power =</span> <span class="fl">.80</span>, <span class="dt">rho2 =</span> <span class="fl">.20</span>,</a>
<a class="sourceLine" id="cb4-7" title="7">                  <span class="dt">g2 =</span> <span class="dv">1</span>, <span class="dt">r21 =</span> <span class="fl">.20</span>, <span class="dt">r22 =</span> <span class="fl">.30</span>,</a>
<a class="sourceLine" id="cb4-8" title="8">                  <span class="dt">p =</span> <span class="fl">.386</span>, <span class="dt">n1 =</span> <span class="dv">24</span>,  <span class="dt">n2 =</span> <span class="ot">NULL</span>)</a></code></pre></div>
<pre><code>## 
## RDDE for normal distribution 
##  based on population moments--------------------------------------- 
## Polynomial order = 1 
## Interaction w/ treatment = TRUE 
## Treat if score &lt; cutoff = TRUE 
## Cutoff = -0.29 | p = 0.386 
## RDDE = 2.736 
## 
## Solution converged with LBFGS 
## 
## Rounded solution: 
## --------------------------------------------------- 
##  [n1]  n2   [p] [cost]  mdes 95%lcl 95%ucl power
##    24 116 0.388  12478 0.364  0.109  0.619 0.338
## --------------------------------------------------- 
## Per unit marginal costs: 
##  Level 1 treatment: 5 
##  Level 1 control: 2 
##  Level 2 treatment: 50 
##  Level 2 control: 20 
## --------------------------------------------------- 
## MDES = 0.364 (with power = 80) 
## power = 0.338 (for ES = 0.2) 
## --------------------------------------------------- 
## []: point constrained (fixed) 
## &lt;&lt;: bound constrained 
## Regression discontinuity design</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co"># CRD w/ quadratic score variable interacting with the treatment</span></a>
<a class="sourceLine" id="cb6-2" title="2">crd2 &lt;-<span class="st"> </span><span class="kw">cosa.crd2</span>(<span class="dt">order =</span> <span class="dv">2</span>, <span class="dt">interaction =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb6-3" title="3">                  <span class="dt">constrain =</span> <span class="st">&quot;cost&quot;</span>, <span class="dt">cost =</span> <span class="dv">12500</span>,</a>
<a class="sourceLine" id="cb6-4" title="4">                  <span class="dt">cn1 =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">2</span>), <span class="dt">cn2 =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb6-5" title="5">                  <span class="dt">es =</span> <span class="fl">.20</span>,  <span class="dt">power =</span> <span class="fl">.80</span>, <span class="dt">rho2 =</span> <span class="fl">.20</span>,</a>
<a class="sourceLine" id="cb6-6" title="6">                  <span class="dt">g2 =</span> <span class="dv">1</span>, <span class="dt">r21 =</span> <span class="fl">.20</span>, <span class="dt">r22 =</span> <span class="fl">.30</span>,</a>
<a class="sourceLine" id="cb6-7" title="7">                  <span class="dt">p =</span> <span class="fl">.386</span>, <span class="dt">n1 =</span> <span class="dv">24</span>,  <span class="dt">n2 =</span> <span class="ot">NULL</span>)</a></code></pre></div>
<pre><code>## 
## RDDE for normal distribution 
##  based on population moments--------------------------------------- 
## Polynomial order = 2 
## Interaction w/ treatment = TRUE 
## Treat if score &lt; cutoff = TRUE 
## Cutoff = -0.29 | p = 0.386 
## RDDE = 4.992 
## 
## Solution converged with LBFGS 
## 
## Rounded solution: 
## --------------------------------------------------- 
##  [n1]  n2   [p] [cost]  mdes 95%lcl 95%ucl power
##    24 116 0.388  12478 0.491  0.147  0.836 0.207
## --------------------------------------------------- 
## Per unit marginal costs: 
##  Level 1 treatment: 5 
##  Level 1 control: 2 
##  Level 2 treatment: 50 
##  Level 2 control: 20 
## --------------------------------------------------- 
## MDES = 0.491 (with power = 80) 
## power = 0.207 (for ES = 0.2) 
## --------------------------------------------------- 
## []: point constrained (fixed) 
## &lt;&lt;: bound constrained 
## Regression discontinuity design</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co"># example plots</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>), <span class="dt">mai =</span> <span class="kw">c</span>(.<span class="dv">6</span>, <span class="fl">.6</span>, <span class="fl">.6</span>, <span class="fl">.2</span>))</a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co"># compare minimum detectable effect size and 95% CI</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="kw">plot</span>(crt, <span class="dt">ypar =</span> <span class="st">&quot;mdes&quot;</span>, <span class="dt">xpar =</span> <span class="st">&quot;n2&quot;</span>,</a>
<a class="sourceLine" id="cb8-5" title="5">     <span class="dt">ylim =</span> <span class="kw">c</span>(.<span class="dv">10</span>, <span class="fl">.90</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">800</span>), </a>
<a class="sourceLine" id="cb8-6" title="6">     <span class="dt">ylab =</span> <span class="st">&quot;MDES (with Power = .80)&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Number of Clusters&quot;</span>,</a>
<a class="sourceLine" id="cb8-7" title="7">     <span class="dt">main =</span> <span class="kw">expression</span>(CRT), <span class="dt">locate =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb8-8" title="8"><span class="kw">plot</span>(crd1, <span class="dt">ypar =</span> <span class="st">&quot;mdes&quot;</span>, <span class="dt">xpar =</span> <span class="st">&quot;n2&quot;</span>,</a>
<a class="sourceLine" id="cb8-9" title="9">     <span class="dt">ylim =</span> <span class="kw">c</span>(.<span class="dv">10</span>, <span class="fl">.90</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">800</span>),</a>
<a class="sourceLine" id="cb8-10" title="10">     <span class="dt">ylab =</span> <span class="st">&quot;MDES (with Power = .80)&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Number of Clusters&quot;</span>,</a>
<a class="sourceLine" id="cb8-11" title="11">     <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">CRD</span> (S <span class="op">+</span><span class="st"> </span>TS)), <span class="dt">locate =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb8-12" title="12"><span class="kw">plot</span>(crd2, <span class="dt">ypar =</span> <span class="st">&quot;mdes&quot;</span>, <span class="dt">xpar =</span> <span class="st">&quot;n2&quot;</span>,</a>
<a class="sourceLine" id="cb8-13" title="13">     <span class="dt">ylim =</span> <span class="kw">c</span>(.<span class="dv">10</span>, <span class="fl">.90</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">800</span>),</a>
<a class="sourceLine" id="cb8-14" title="14">     <span class="dt">ylab =</span> <span class="st">&quot;MDES (with Power = .80)&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Number of Clusters&quot;</span>,</a>
<a class="sourceLine" id="cb8-15" title="15">     <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">CRD</span> (S <span class="op">+</span><span class="st"> </span>S<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>TS <span class="op">+</span><span class="st"> </span>TS<span class="op">^</span><span class="dv">2</span>)), <span class="dt">locate =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb8-16" title="16"><span class="co"># compare statistical power </span></a>
<a class="sourceLine" id="cb8-17" title="17"><span class="kw">plot</span>(crt, <span class="dt">ypar =</span> <span class="st">&quot;power&quot;</span>, <span class="dt">xpar =</span> <span class="st">&quot;n2&quot;</span>,</a>
<a class="sourceLine" id="cb8-18" title="18">     <span class="dt">ylim =</span> <span class="kw">c</span>(.<span class="dv">10</span>, <span class="fl">.85</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">800</span>), </a>
<a class="sourceLine" id="cb8-19" title="19">     <span class="dt">ylab =</span> <span class="st">&quot;Power (for ES = .20)&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Number of Clusters&quot;</span>,</a>
<a class="sourceLine" id="cb8-20" title="20">     <span class="dt">main =</span> <span class="kw">expression</span>(CRT), <span class="dt">locate =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb8-21" title="21"><span class="kw">plot</span>(crd1, <span class="dt">ypar =</span> <span class="st">&quot;power&quot;</span>, <span class="dt">xpar =</span> <span class="st">&quot;n2&quot;</span>,</a>
<a class="sourceLine" id="cb8-22" title="22">     <span class="dt">ylim =</span> <span class="kw">c</span>(.<span class="dv">10</span>, <span class="fl">.85</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">800</span>), </a>
<a class="sourceLine" id="cb8-23" title="23">     <span class="dt">ylab =</span> <span class="st">&quot;Power (for ES = .20)&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Number of Clusters&quot;</span>,</a>
<a class="sourceLine" id="cb8-24" title="24">     <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">CRD</span>(S <span class="op">+</span><span class="st"> </span>TS)), <span class="dt">locate =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb8-25" title="25"><span class="kw">plot</span>(crd2, <span class="dt">ypar =</span> <span class="st">&quot;power&quot;</span>, <span class="dt">xpar =</span> <span class="st">&quot;n2&quot;</span>,</a>
<a class="sourceLine" id="cb8-26" title="26">     <span class="dt">ylim =</span> <span class="kw">c</span>(.<span class="dv">10</span>, <span class="fl">.85</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">800</span>), </a>
<a class="sourceLine" id="cb8-27" title="27">     <span class="dt">ylab =</span> <span class="st">&quot;Power (for ES = .20)&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Number of Clusters&quot;</span>,</a>
<a class="sourceLine" id="cb8-28" title="28">     <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">CRD</span> (S <span class="op">+</span><span class="st"> </span>S<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>TS <span class="op">+</span><span class="st"> </span>TS<span class="op">^</span><span class="dv">2</span>)), <span class="dt">locate =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As seen from the MDES and power plots, a little less than 150 clusters are needed to obtain the benchmark power rate of 80% for the CRT, more than 350 cluster are needed for CRD with linear score variable interacting with the treatment, and more than 650 clusters are needed for CRD with quadratic score variable interacting with the treatment. Precise number of clusters can be found via placing the primary constraint on either the effect size or the power rate.</p>
</div>
<div id="primary-constraint-on-the-effect-size" class="section level2">
<h2>Primary Constraint on the Effect Size</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="co"># cost constrained - optimize p and n2</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="co"># CRT(&#39;order = 0&#39; or &#39;rhots = 0&#39;)</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="kw">cosa.crd2</span>(<span class="dt">order =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb9-4" title="4">          <span class="dt">constrain =</span> <span class="st">&quot;es&quot;</span>, <span class="dt">es =</span> <span class="fl">.20</span>,  </a>
<a class="sourceLine" id="cb9-5" title="5">          <span class="dt">cn1 =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">2</span>), <span class="dt">cn2 =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb9-6" title="6">          <span class="dt">power =</span> <span class="fl">.80</span>, <span class="dt">rho2 =</span> <span class="fl">.20</span>,</a>
<a class="sourceLine" id="cb9-7" title="7">          <span class="dt">g2 =</span> <span class="dv">1</span>, <span class="dt">r21 =</span> <span class="fl">.20</span>, <span class="dt">r22 =</span> <span class="fl">.30</span>, </a>
<a class="sourceLine" id="cb9-8" title="8">          <span class="dt">p =</span> <span class="ot">NULL</span>, <span class="dt">n1 =</span> <span class="dv">20</span>,  <span class="dt">n2 =</span> <span class="ot">NULL</span>)</a></code></pre></div>
<pre><code>## Solution converged with SLSQP 
## 
## Rounded solution: 
## --------------------------------------------------- 
##  [n1]  n2     p  cost [mdes] 95%lcl 95%ucl power
##    20 144 0.389 13680    0.2   0.06   0.34   0.8
## --------------------------------------------------- 
## Per unit marginal costs: 
##  Level 1 treatment: 5 
##  Level 1 control: 2 
##  Level 2 treatment: 50 
##  Level 2 control: 20 
## --------------------------------------------------- 
## MDES = 0.2 (with power = 80) 
## power = 0.8 (for ES = 0.2) 
## --------------------------------------------------- 
## []: point constrained (fixed) 
## &lt;&lt;: bound constrained 
## Random assignment design</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co"># comparisons to CRDs</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="co"># CRD w/ linear score variable interacting with the treatment</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="kw">cosa.crd2</span>(<span class="dt">order =</span> <span class="dv">1</span>, <span class="dt">interaction =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb11-4" title="4">          <span class="dt">constrain =</span> <span class="st">&quot;es&quot;</span>, <span class="dt">es =</span> <span class="fl">.20</span>,  </a>
<a class="sourceLine" id="cb11-5" title="5">          <span class="dt">cn1 =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">2</span>), <span class="dt">cn2 =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb11-6" title="6">          <span class="dt">power =</span> <span class="fl">.80</span>, <span class="dt">rho2 =</span> <span class="fl">.20</span>,</a>
<a class="sourceLine" id="cb11-7" title="7">          <span class="dt">g2 =</span> <span class="dv">1</span>, <span class="dt">r21 =</span> <span class="fl">.20</span>, <span class="dt">r22 =</span> <span class="fl">.30</span>,</a>
<a class="sourceLine" id="cb11-8" title="8">          <span class="dt">p =</span> <span class="fl">.389</span>, <span class="dt">n1 =</span> <span class="dv">24</span>,  <span class="dt">n2 =</span> <span class="ot">NULL</span>)</a></code></pre></div>
<pre><code>## 
## RDDE for normal distribution 
##  based on population moments--------------------------------------- 
## Polynomial order = 1 
## Interaction w/ treatment = TRUE 
## Treat if score &lt; cutoff = TRUE 
## Cutoff = -0.282 | p = 0.389 
## RDDE = 2.737 
## 
## Solution converged with SLSQP 
## 
## Rounded solution: 
## --------------------------------------------------- 
##  [n1]  n2   [p]  cost [mdes] 95%lcl 95%ucl power
##    24 379 0.388 40766    0.2   0.06   0.34   0.8
## --------------------------------------------------- 
## Per unit marginal costs: 
##  Level 1 treatment: 5 
##  Level 1 control: 2 
##  Level 2 treatment: 50 
##  Level 2 control: 20 
## --------------------------------------------------- 
## MDES = 0.2 (with power = 80) 
## power = 0.8 (for ES = 0.2) 
## --------------------------------------------------- 
## []: point constrained (fixed) 
## &lt;&lt;: bound constrained 
## Regression discontinuity design</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="co"># CRD w/ quadratic score variable interacting with the treatment</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="kw">cosa.crd2</span>(<span class="dt">order =</span> <span class="dv">2</span>, <span class="dt">interaction =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb13-3" title="3">          <span class="dt">constrain =</span> <span class="st">&quot;es&quot;</span>, <span class="dt">es =</span> <span class="fl">.20</span>,  </a>
<a class="sourceLine" id="cb13-4" title="4">          <span class="dt">cn1 =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">2</span>), <span class="dt">cn2 =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb13-5" title="5">          <span class="dt">power =</span> <span class="fl">.80</span>, <span class="dt">rho2 =</span> <span class="fl">.20</span>,</a>
<a class="sourceLine" id="cb13-6" title="6">          <span class="dt">g2 =</span> <span class="dv">1</span>, <span class="dt">r21 =</span> <span class="fl">.20</span>, <span class="dt">r22 =</span> <span class="fl">.30</span>,</a>
<a class="sourceLine" id="cb13-7" title="7">          <span class="dt">p =</span> <span class="fl">.389</span>, <span class="dt">n1 =</span> <span class="dv">24</span>,  <span class="dt">n2 =</span> <span class="ot">NULL</span>)</a></code></pre></div>
<pre><code>## 
## RDDE for normal distribution 
##  based on population moments--------------------------------------- 
## Polynomial order = 2 
## Interaction w/ treatment = TRUE 
## Treat if score &lt; cutoff = TRUE 
## Cutoff = -0.282 | p = 0.389 
## RDDE = 4.994 
## 
## Solution converged with SLSQP 
## 
## Rounded solution: 
## --------------------------------------------------- 
##  [n1]  n2   [p]  cost [mdes] 95%lcl 95%ucl power
##    24 689 0.389 74188    0.2   0.06   0.34   0.8
## --------------------------------------------------- 
## Per unit marginal costs: 
##  Level 1 treatment: 5 
##  Level 1 control: 2 
##  Level 2 treatment: 50 
##  Level 2 control: 20 
## --------------------------------------------------- 
## MDES = 0.2 (with power = 80) 
## power = 0.8 (for ES = 0.2) 
## --------------------------------------------------- 
## []: point constrained (fixed) 
## &lt;&lt;: bound constrained 
## Regression discontinuity design</code></pre>
</div>
<div id="primary-constraint-on-the-power-rate" class="section level2">
<h2>Primary Constraint on the Power Rate</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="co"># cost constrained - optimize p and n2</span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="co"># CRT(&#39;order = 0&#39; or &#39;rhots = 0&#39;)</span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="kw">cosa.crd2</span>(<span class="dt">order =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb15-4" title="4">          <span class="dt">constrain =</span> <span class="st">&quot;power&quot;</span>, <span class="dt">power =</span> <span class="fl">.80</span>, </a>
<a class="sourceLine" id="cb15-5" title="5">          <span class="dt">cn1 =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">2</span>), <span class="dt">cn2 =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb15-6" title="6">          <span class="dt">es =</span> <span class="fl">.20</span>, <span class="dt">rho2 =</span> <span class="fl">.20</span>,</a>
<a class="sourceLine" id="cb15-7" title="7">          <span class="dt">g2 =</span> <span class="dv">1</span>, <span class="dt">r21 =</span> <span class="fl">.20</span>, <span class="dt">r22 =</span> <span class="fl">.30</span>, </a>
<a class="sourceLine" id="cb15-8" title="8">          <span class="dt">p =</span> <span class="ot">NULL</span>, <span class="dt">n1 =</span> <span class="dv">20</span>,  <span class="dt">n2 =</span> <span class="ot">NULL</span>)</a></code></pre></div>
<pre><code>## Solution converged with SLSQP 
## 
## Rounded solution: 
## --------------------------------------------------- 
##  [n1]  n2     p  cost mdes 95%lcl 95%ucl [power]
##    20 144 0.389 13680  0.2   0.06   0.34     0.8
## --------------------------------------------------- 
## Per unit marginal costs: 
##  Level 1 treatment: 5 
##  Level 1 control: 2 
##  Level 2 treatment: 50 
##  Level 2 control: 20 
## --------------------------------------------------- 
## MDES = 0.2 (with power = 80) 
## power = 0.8 (for ES = 0.2) 
## --------------------------------------------------- 
## []: point constrained (fixed) 
## &lt;&lt;: bound constrained 
## Random assignment design</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co"># comparisons to CRDs</span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="co"># CRD w/ linear score variable interacting with the treatment</span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="kw">cosa.crd2</span>(<span class="dt">order =</span> <span class="dv">1</span>, <span class="dt">interaction =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb17-4" title="4">          <span class="dt">constrain =</span> <span class="st">&quot;power&quot;</span>, <span class="dt">power =</span> <span class="fl">.80</span>, </a>
<a class="sourceLine" id="cb17-5" title="5">          <span class="dt">cn1 =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">2</span>), <span class="dt">cn2 =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb17-6" title="6">          <span class="dt">es =</span> <span class="fl">.20</span>, <span class="dt">rho2 =</span> <span class="fl">.20</span>,</a>
<a class="sourceLine" id="cb17-7" title="7">          <span class="dt">g2 =</span> <span class="dv">1</span>, <span class="dt">r21 =</span> <span class="fl">.20</span>, <span class="dt">r22 =</span> <span class="fl">.30</span>,</a>
<a class="sourceLine" id="cb17-8" title="8">          <span class="dt">p =</span> <span class="fl">.389</span>, <span class="dt">n1 =</span> <span class="dv">24</span>,  <span class="dt">n2 =</span> <span class="ot">NULL</span>)</a></code></pre></div>
<pre><code>## 
## RDDE for normal distribution 
##  based on population moments--------------------------------------- 
## Polynomial order = 1 
## Interaction w/ treatment = TRUE 
## Treat if score &lt; cutoff = TRUE 
## Cutoff = -0.282 | p = 0.389 
## RDDE = 2.737 
## 
## Solution converged with SLSQP 
## 
## Rounded solution: 
## --------------------------------------------------- 
##  [n1]  n2   [p]  cost mdes 95%lcl 95%ucl [power]
##    24 378 0.389 40698  0.2   0.06   0.34   0.799
## --------------------------------------------------- 
## Per unit marginal costs: 
##  Level 1 treatment: 5 
##  Level 1 control: 2 
##  Level 2 treatment: 50 
##  Level 2 control: 20 
## --------------------------------------------------- 
## MDES = 0.2 (with power = 80) 
## power = 0.799 (for ES = 0.2) 
## --------------------------------------------------- 
## []: point constrained (fixed) 
## &lt;&lt;: bound constrained 
## Regression discontinuity design</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="co"># CRD w/ quadratic score variable interacting with the treatment</span></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="kw">cosa.crd2</span>(<span class="dt">order =</span> <span class="dv">2</span>, <span class="dt">interaction =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb19-3" title="3">          <span class="dt">constrain =</span> <span class="st">&quot;power&quot;</span>, <span class="dt">power =</span> <span class="fl">.80</span>,  </a>
<a class="sourceLine" id="cb19-4" title="4">          <span class="dt">cn1 =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">2</span>), <span class="dt">cn2 =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb19-5" title="5">          <span class="dt">es =</span> <span class="fl">.20</span>, <span class="dt">rho2 =</span> <span class="fl">.20</span>,</a>
<a class="sourceLine" id="cb19-6" title="6">          <span class="dt">g2 =</span> <span class="dv">1</span>, <span class="dt">r21 =</span> <span class="fl">.20</span>, <span class="dt">r22 =</span> <span class="fl">.30</span>,</a>
<a class="sourceLine" id="cb19-7" title="7">          <span class="dt">p =</span> <span class="fl">.389</span>, <span class="dt">n1 =</span> <span class="dv">24</span>,  <span class="dt">n2 =</span> <span class="ot">NULL</span>)</a></code></pre></div>
<pre><code>## 
## RDDE for normal distribution 
##  based on population moments--------------------------------------- 
## Polynomial order = 2 
## Interaction w/ treatment = TRUE 
## Treat if score &lt; cutoff = TRUE 
## Cutoff = -0.282 | p = 0.389 
## RDDE = 4.994 
## 
## Solution converged with SLSQP 
## 
## Rounded solution: 
## --------------------------------------------------- 
##  [n1]  n2   [p]  cost mdes 95%lcl 95%ucl [power]
##    24 689 0.389 74188  0.2   0.06   0.34     0.8
## --------------------------------------------------- 
## Per unit marginal costs: 
##  Level 1 treatment: 5 
##  Level 1 control: 2 
##  Level 2 treatment: 50 
##  Level 2 control: 20 
## --------------------------------------------------- 
## MDES = 0.2 (with power = 80) 
## power = 0.8 (for ES = 0.2) 
## --------------------------------------------------- 
## []: point constrained (fixed) 
## &lt;&lt;: bound constrained 
## Regression discontinuity design</code></pre>
<p>o</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
