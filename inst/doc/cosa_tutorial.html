<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Metin Bulus" />

<meta name="date" content="2019-05-09" />

<title></title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */


</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore"><h1 style="color: grey;">
Bound Constrained Optimal Design of Multilevel Regression Discontinuity Designs and Randomized Controlled Trials
</h1></h1>
<h4 class="author"><em>Metin Bulus</em></h4>
<h4 class="date"><em>2019-05-09</em></h4>


<div id="TOC">
<ul>
<li><a href="#primary-constraint-on-the-total-cost">Primary Constraint on the Total Cost</a></li>
<li><a href="#primary-constraint-on-the-effect-size">Primary Constraint on the Effect Size</a></li>
<li><a href="#primary-constraint-on-the-power-rate">Primary Constraint on the Power Rate</a></li>
</ul>
</div>

<p>To install and load the package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;cosa&quot;</span>)
<span class="kw">library</span>(cosa)</code></pre></div>
<p>The following examples demonstrate how to perform bound constrained optimal sample allocation (BCOSA) for a two-level cluster randomized trial (CRT) and for the corresponding cluster-level regression discontinuity (CRD) design under three primary constraints. Note: <code>NULL</code> arguments are provided for clarity, otherwise they do not have to be explicit.</p>
<div id="primary-constraint-on-the-total-cost" class="section level2">
<h2>Primary Constraint on the Total Cost</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># CRT('rhots = 0')</span>
<span class="co"># cost constrained - optimize p and n2</span>
crt &lt;-<span class="st"> </span><span class="kw">cosa.crd2r2</span>(<span class="dt">rhots =</span> <span class="dv">0</span>,
                   <span class="dt">constrain =</span> <span class="st">&quot;cost&quot;</span>, <span class="dt">cost =</span> <span class="dv">12500</span>, 
                   <span class="dt">cn1 =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">2</span>), <span class="dt">cn2 =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">20</span>),
                   <span class="dt">es =</span> .<span class="dv">20</span>,  <span class="dt">power =</span> .<span class="dv">80</span>, <span class="dt">rho2 =</span> .<span class="dv">20</span>,
                   <span class="dt">g2 =</span> <span class="dv">5</span>, <span class="dt">r21 =</span> .<span class="dv">20</span>, <span class="dt">r22 =</span> .<span class="dv">30</span>,
                   <span class="dt">p =</span> <span class="ot">NULL</span>, <span class="dt">n1 =</span> <span class="dv">24</span>,  <span class="dt">n2 =</span> <span class="ot">NULL</span>)</code></pre></div>
<pre><code>## 
## Results are equivalent to corresponding random assignment designs 
## Solution converged with LBFGS 
## 
## Rounded solution: 
## --------------------------------------------------- 
##  [n1]  n2     p [cost] mdes 95%lcl 95%ucl power
##    24 116 0.388  12478 0.22  0.066  0.374 0.722
## --------------------------------------------------- 
## Per unit marginal costs: 
##  Level 1 treatment: 5 
##  Level 1 control: 2 
##  Level 2 treatment: 50 
##  Level 2 control: 20 
## --------------------------------------------------- 
## MDES = 0.22 (with power = 80) 
## power = 0.722 (for ES = 0.2) 
## --------------------------------------------------- 
## []: point constrained (fixed) 
## &lt;&lt;: bound constrained</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># CRD</span>
<span class="co"># cost constrained - optimize n2</span>
crd &lt;-<span class="st"> </span><span class="kw">cosa.crd2r2</span>(<span class="dt">constrain =</span> <span class="st">&quot;cost&quot;</span>, <span class="dt">cost =</span> <span class="dv">12500</span>,
                   <span class="dt">cn1 =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">2</span>), <span class="dt">cn2 =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">20</span>),
                   <span class="dt">es =</span> .<span class="dv">20</span>,  <span class="dt">power =</span> .<span class="dv">80</span>, <span class="dt">rho2 =</span> .<span class="dv">20</span>,
                   <span class="dt">g2 =</span> <span class="dv">5</span>, <span class="dt">r21 =</span> .<span class="dv">20</span>, <span class="dt">r22 =</span> .<span class="dv">30</span>,
                   <span class="dt">p =</span> .<span class="dv">387</span>, <span class="dt">n1 =</span> <span class="dv">24</span>,  <span class="dt">n2 =</span> <span class="ot">NULL</span>)</code></pre></div>
<pre><code>## Solution converged with LBFGS 
## 
## Rounded solution: 
## --------------------------------------------------- 
##  [n1]  n2   [p] [cost]  mdes 95%lcl 95%ucl power
##    24 116 0.388  12478 0.356  0.106  0.605 0.351
## --------------------------------------------------- 
## Per unit marginal costs: 
##  Level 1 treatment: 5 
##  Level 1 control: 2 
##  Level 2 treatment: 50 
##  Level 2 control: 20 
## --------------------------------------------------- 
## MDES = 0.356 (with power = 80) 
## power = 0.351 (for ES = 0.2) 
## --------------------------------------------------- 
## []: point constrained (fixed) 
## &lt;&lt;: bound constrained</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># example plots</span>
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">mai =</span> <span class="kw">c</span>(<span class="dv">1</span>, .<span class="dv">9</span>, .<span class="dv">5</span>, .<span class="dv">2</span>))
<span class="co"># compare minimum detectable effect size and 95% CI</span>
<span class="kw">plot</span>(crt, <span class="dt">ypar =</span> <span class="st">&quot;mdes&quot;</span>, <span class="dt">xpar =</span> <span class="st">&quot;n2&quot;</span>,
     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">200</span>), 
     <span class="dt">ylab =</span> <span class="st">&quot;MDES (with Power = .80)&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Number of Clusters&quot;</span>,
     <span class="dt">main =</span> <span class="st">&quot;CRT&quot;</span>, <span class="dt">locate =</span> <span class="ot">TRUE</span>)
<span class="kw">plot</span>(crd, <span class="dt">ypar =</span> <span class="st">&quot;mdes&quot;</span>, <span class="dt">xpar =</span> <span class="st">&quot;n2&quot;</span>,
     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">200</span>),
     <span class="dt">ylab =</span> <span class="st">&quot;MDES (with Power = .80)&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Number of Clusters&quot;</span>,
     <span class="dt">main =</span> <span class="st">&quot;CRD&quot;</span>, <span class="dt">locate =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># compare statistical power </span>
<span class="kw">plot</span>(crt, <span class="dt">ypar =</span> <span class="st">&quot;power&quot;</span>, <span class="dt">xpar =</span> <span class="st">&quot;n2&quot;</span>,
     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">200</span>), 
     <span class="dt">ylab =</span> <span class="st">&quot;Power (for ES = .20)&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Number of Clusters&quot;</span>,
     <span class="dt">main =</span> <span class="st">&quot;CRT&quot;</span>, <span class="dt">locate =</span> <span class="ot">TRUE</span>)
<span class="kw">plot</span>(crd, <span class="dt">ypar =</span> <span class="st">&quot;power&quot;</span>, <span class="dt">xpar =</span> <span class="st">&quot;n2&quot;</span>,
     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">200</span>), 
     <span class="dt">ylab =</span> <span class="st">&quot;Power (for ES = .20)&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Number of Clusters&quot;</span>,
     <span class="dt">main =</span> <span class="st">&quot;CRD&quot;</span>, <span class="dt">locate =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As seen from the MDES and power plots, a little less than 150 clusters are needed to obtain the benchmark power rate of 80% for the CRT (more than 200 clusters for the CRD). Precise number of clusters can be found via placing the primary constraint on either the effect size or power rate.</p>
</div>
<div id="primary-constraint-on-the-effect-size" class="section level2">
<h2>Primary Constraint on the Effect Size</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># CRT('rhots = 0')</span>
<span class="co"># cost constrained - optimize p and n2</span>
<span class="kw">cosa.crd2r2</span>(<span class="dt">rhots =</span> <span class="dv">0</span>,
            <span class="dt">constrain =</span> <span class="st">&quot;es&quot;</span>, <span class="dt">es =</span> .<span class="dv">20</span>,
            <span class="dt">cn1 =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">2</span>), <span class="dt">cn2 =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">20</span>),
            <span class="dt">power =</span> .<span class="dv">80</span>, <span class="dt">rho2 =</span> .<span class="dv">20</span>,
            <span class="dt">g2 =</span> <span class="dv">5</span>, <span class="dt">r21 =</span> .<span class="dv">20</span>, <span class="dt">r22 =</span> .<span class="dv">30</span>,
            <span class="dt">p =</span> <span class="ot">NULL</span>, <span class="dt">n1 =</span> <span class="dv">24</span>,  <span class="dt">n2 =</span> <span class="ot">NULL</span>)</code></pre></div>
<pre><code>## 
## Results are equivalent to corresponding random assignment designs 
## Solution converged with SLSQP 
## 
## Rounded solution: 
## --------------------------------------------------- 
##  [n1]  n2     p  cost [mdes] 95%lcl 95%ucl power
##    24 140 0.386 15028    0.2   0.06   0.34   0.8
## --------------------------------------------------- 
## Per unit marginal costs: 
##  Level 1 treatment: 5 
##  Level 1 control: 2 
##  Level 2 treatment: 50 
##  Level 2 control: 20 
## --------------------------------------------------- 
## MDES = 0.2 (with power = 80) 
## power = 0.8 (for ES = 0.2) 
## --------------------------------------------------- 
## []: point constrained (fixed) 
## &lt;&lt;: bound constrained</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># CRD</span>
<span class="co"># cost constrained - optimize n2</span>
<span class="kw">cosa.crd2r2</span>(<span class="dt">constrain =</span> <span class="st">&quot;es&quot;</span>, <span class="dt">es =</span> .<span class="dv">20</span>,
            <span class="dt">power =</span> .<span class="dv">80</span>, <span class="dt">rho2 =</span> .<span class="dv">20</span>,
            <span class="dt">cn1 =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">2</span>), <span class="dt">cn2 =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">20</span>),
            <span class="dt">g2 =</span> <span class="dv">5</span>, <span class="dt">r21 =</span> .<span class="dv">20</span>, <span class="dt">r22 =</span> .<span class="dv">30</span>,
            <span class="dt">p =</span> .<span class="dv">386</span>, <span class="dt">n1 =</span> <span class="dv">24</span>,  <span class="dt">n2 =</span> <span class="ot">NULL</span>)</code></pre></div>
<pre><code>## Solution converged with SLSQP 
## 
## Rounded solution: 
## --------------------------------------------------- 
##  [n1]  n2   [p]  cost [mdes] 95%lcl 95%ucl power
##    24 363 0.386 38964    0.2   0.06   0.34   0.8
## --------------------------------------------------- 
## Per unit marginal costs: 
##  Level 1 treatment: 5 
##  Level 1 control: 2 
##  Level 2 treatment: 50 
##  Level 2 control: 20 
## --------------------------------------------------- 
## MDES = 0.2 (with power = 80) 
## power = 0.8 (for ES = 0.2) 
## --------------------------------------------------- 
## []: point constrained (fixed) 
## &lt;&lt;: bound constrained</code></pre>
</div>
<div id="primary-constraint-on-the-power-rate" class="section level2">
<h2>Primary Constraint on the Power Rate</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># CRT('rhots = 0')</span>
<span class="co"># cost constrained - optimize p and n2</span>
<span class="kw">cosa.crd2r2</span>(<span class="dt">rhots =</span> <span class="dv">0</span>, 
            <span class="dt">constrain =</span> <span class="st">&quot;power&quot;</span>, <span class="dt">power =</span> .<span class="dv">80</span>,
            <span class="dt">cn1 =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">2</span>), <span class="dt">cn2 =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">20</span>),
            <span class="dt">es =</span> .<span class="dv">20</span>, <span class="dt">rho2 =</span> .<span class="dv">20</span>,
            <span class="dt">g2 =</span> <span class="dv">5</span>, <span class="dt">r21 =</span> .<span class="dv">20</span>, <span class="dt">r22 =</span> .<span class="dv">30</span>,
            <span class="dt">p =</span> <span class="ot">NULL</span>, <span class="dt">n1 =</span> <span class="dv">24</span>,  <span class="dt">n2 =</span> <span class="ot">NULL</span>)</code></pre></div>
<pre><code>## 
## Results are equivalent to corresponding random assignment designs 
## Solution converged with SLSQP 
## 
## Rounded solution: 
## --------------------------------------------------- 
##  [n1]  n2     p  cost mdes 95%lcl 95%ucl [power]
##    24 140 0.386 15028  0.2   0.06   0.34     0.8
## --------------------------------------------------- 
## Per unit marginal costs: 
##  Level 1 treatment: 5 
##  Level 1 control: 2 
##  Level 2 treatment: 50 
##  Level 2 control: 20 
## --------------------------------------------------- 
## MDES = 0.2 (with power = 80) 
## power = 0.8 (for ES = 0.2) 
## --------------------------------------------------- 
## []: point constrained (fixed) 
## &lt;&lt;: bound constrained</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># the cost reduction for using an unbalanced design might be trivial</span>
<span class="co"># fix p = .50 to obtain the cost under the balanced design for comparison</span>
<span class="kw">cosa.crd2r2</span>(<span class="dt">rhots =</span> <span class="dv">0</span>, 
            <span class="dt">constrain =</span> <span class="st">&quot;power&quot;</span>, <span class="dt">power =</span> .<span class="dv">80</span>,
            <span class="dt">cn1 =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">2</span>), <span class="dt">cn2 =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">20</span>),
            <span class="dt">es =</span> .<span class="dv">20</span>, <span class="dt">rho2 =</span> .<span class="dv">20</span>,
            <span class="dt">g2 =</span> <span class="dv">5</span>, <span class="dt">r21 =</span> .<span class="dv">20</span>, <span class="dt">r22 =</span> .<span class="dv">30</span>,
            <span class="dt">p =</span> .<span class="dv">50</span>, <span class="dt">n1 =</span> <span class="dv">24</span>,  <span class="dt">n2 =</span> <span class="ot">NULL</span>)</code></pre></div>
<pre><code>## 
## Results are equivalent to corresponding random assignment designs 
## Solution converged with SLSQP 
## 
## Rounded solution: 
## --------------------------------------------------- 
##  [n1]  n2   [p]  cost mdes 95%lcl 95%ucl [power]
##    24 133 0.496 15776  0.2   0.06   0.34     0.8
## --------------------------------------------------- 
## Per unit marginal costs: 
##  Level 1 treatment: 5 
##  Level 1 control: 2 
##  Level 2 treatment: 50 
##  Level 2 control: 20 
## --------------------------------------------------- 
## MDES = 0.2 (with power = 80) 
## power = 0.8 (for ES = 0.2) 
## --------------------------------------------------- 
## []: point constrained (fixed) 
## &lt;&lt;: bound constrained</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># CRD</span>
<span class="co"># cost constrained - optimize n2</span>
<span class="kw">cosa.crd2r2</span>(<span class="dt">constrain =</span> <span class="st">&quot;power&quot;</span>, <span class="dt">power =</span> .<span class="dv">80</span>,
            <span class="dt">cn1 =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">2</span>), <span class="dt">cn2 =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">20</span>),
            <span class="dt">es =</span> .<span class="dv">20</span>, <span class="dt">rho2 =</span> .<span class="dv">20</span>,
            <span class="dt">g2 =</span> <span class="dv">5</span>, <span class="dt">r21 =</span> .<span class="dv">20</span>, <span class="dt">r22 =</span> .<span class="dv">30</span>,
            <span class="dt">p =</span> .<span class="dv">386</span>, <span class="dt">n1 =</span> <span class="dv">24</span>,  <span class="dt">n2 =</span> <span class="ot">NULL</span>)</code></pre></div>
<pre><code>## Solution converged with SLSQP 
## 
## Rounded solution: 
## --------------------------------------------------- 
##  [n1]  n2   [p]  cost mdes 95%lcl 95%ucl [power]
##    24 363 0.386 38964  0.2   0.06   0.34     0.8
## --------------------------------------------------- 
## Per unit marginal costs: 
##  Level 1 treatment: 5 
##  Level 1 control: 2 
##  Level 2 treatment: 50 
##  Level 2 control: 20 
## --------------------------------------------------- 
## MDES = 0.2 (with power = 80) 
## power = 0.8 (for ES = 0.2) 
## --------------------------------------------------- 
## []: point constrained (fixed) 
## &lt;&lt;: bound constrained</code></pre>
<p>–o–</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
